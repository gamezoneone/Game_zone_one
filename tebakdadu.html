<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Tebak Dadu Fantasi - GameZone</title>
  <link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&family=Orbitron:wght@400;700&family=Luckiest+Guy&family=Poppins:wght@400;700&display=swap" rel="stylesheet">
  <style>
    /* Global Styles (dari profil.html) */
    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&display=swap');
    @import url('https://fonts.googleapis.com/css2?family=Share+Tech+Mono&family=Orbitron:wght@400;700&display=swap');

    :root {
        --neon-green: #00ff00;
        --neon-blue: #00ffff;
        --neon-purple: #ff00ff;
        --dark-bg: #1a0033; /* Dark purple/black */
        --light-text: #e0e0e0;
        --accent-glow: 0 0 10px var(--neon-blue), 0 0 20px var(--neon-blue), 0 0 30px var(--neon-blue);
        --btn-glow: 0 0 8px var(--neon-green), 0 0 15px var(--neon-green);
    }

    * { box-sizing: border-box; }
    body, html {
      margin: 0; padding: 0; min-height: 100vh;
      font-family: 'Poppins', sans-serif;
      background: var(--dark-bg); /* Solid dark background */
      /* Hapus animasi gradient karena profil.html menggunakan solid background */
      color: var(--light-text);
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 0px; /* Kembali ke padding standar untuk fleksibilitas */
      overflow-y: auto; /* Allow vertical scroll if content overflows */
      overflow-x: hidden; /* Prevent horizontal scroll */
    }

    /* Game Container */
    .game-container {
      max-width: 600px;
      width: 100%;
      background: rgba(0,0,0,0.8); /* Background yang lebih gelap */
      border-radius: 20px;
      padding: 30px;
      border: 3px solid var(--neon-blue); /* Border neon blue */
      box-shadow: 0 0 25px rgba(0, 255, 255, 0.7); /* Glow neon blue */
      text-align: center;
      position: relative;
      overflow: hidden; /* For particles */
      animation: pulsateGlow 2s infinite alternate; /* Tetap pertahankan pulsate glow */
      min-height: 80vh; /* Make it taller to match profil.html feel */
      display: flex;
      flex-direction: column;
      justify-content: space-between;
    }

    @keyframes pulsateGlow {
        from { box-shadow: 0 0 20px rgba(0, 255, 255, 0.5); }
        to { box-shadow: 0 0 40px rgba(0, 255, 255, 1); }
    }

    /* Particles Effect (disesuaikan agar sesuai tema) */
    .particle {
        position: absolute;
        background-color: rgba(0, 255, 255, 0.6); /* Warna partikel cyan */
        border-radius: 50%;
        animation: floatAndFade 5s infinite ease-out;
        opacity: 0;
        pointer-events: none;
        z-index: -1; /* Behind content */
    }

    @keyframes floatAndFade {
        0% { transform: translateY(0) translateX(0); opacity: 0; }
        10% { opacity: 0.8; }
        100% { transform: translateY(-150px) translateX(var(--x-offset)); opacity: 0; }
    }

    /* Titles and Saldo (disesuaikan dengan profil.html) */
    h1 {
      font-family: 'Orbitron', sans-serif; /* Ganti font title */
      color: var(--neon-green); /* Warna hijau neon */
      text-shadow: 0 0 10px var(--neon-green), 0 0 20px var(--neon-green), 0 0 30px var(--neon-green);
      margin-bottom: 20px; /* Sedikit lebih besar */
      font-size: 2em; /* Ukuran lebih besar */
      letter-spacing: 2px;
    }

    /* Saldo display (dibuat mirip dengan saldo di profil.html) */
    .saldo-container {
        width: 100%;
        margin-bottom: 25px;
        text-align: center;
    }
    .saldo {
        display: inline-block;
        padding: 1px 2px;
        background: rgba(0, 0, 0, 0.7);
        border-radius: 10px;
        border: 2px solid var(--neon-green);
        box-shadow: 0 0 15px rgba(0, 255, 0, 0.7);
        color: var(--neon-green);
        font-family: 'Orbitron', sans-serif;
        font-size: 1.8em;
        font-weight: 700;
        text-shadow: 0 0 8px rgba(0, 255, 0, 0.7);
    }

    /* Dice Area */
    .dice-area {
      display: flex;
      justify-content: center;
      gap: 15px; /* Jarak antar dadu sedikit lebih besar */
      margin-bottom: 30px; /* Jarak ke elemen berikutnya */
      min-height: 100px; /* Sesuaikan min-height */
      align-items: center;
    }
    /* Base Dice Styling - TIDAK BERUBAH SESUAI PERMINTAAN */
    .dice, .guess-box {
        width: 70px;
        height: 70px;
        background: #fefefe;
        border-radius: 15px;
        display: flex;
        justify-content: center;
        align-items: center;
        box-shadow: inset 0 0 10px rgba(0,0,0,0.4), 0 3px 10px rgba(0,0,0,0.3);
        border: 2px solid #ff9500; /* Border oranye asli dadu */
        transition: transform 0.1s ease-out;
        position: relative;
        flex-shrink: 0;
    }
    /* Dice dots - TIDAK BERUBAH SESUAI PERMINTAAN */
    .dice .dot, .guess-box .dot {
        position: absolute;
        background: red;
        width: 10px;
        height: 10px;
        border-radius: 50%;
    }
    /* Dot positioning - TIDAK BERUBAH SESUAI PERMINTAAN */
    .dice[data-value="1"] .dot:nth-child(1), .guess-box[data-value="1"] .dot:nth-child(1) { top: 50%; left: 50%; transform: translate(-50%, -50%); }
    .dice[data-value="2"] .dot:nth-child(1), .guess-box[data-value="2"] .dot:nth-child(1) { top: 15%; left: 15%; }
    .dice[data-value="2"] .dot:nth-child(2), .guess-box[data-value="2"] .dot:nth-child(2) { bottom: 15%; right: 15%; }
    .dice[data-value="3"] .dot:nth-child(1), .guess-box[data-value="3"] .dot:nth-child(1) { top: 15%; left: 15%; }
    .dice[data-value="3"] .dot:nth-child(2), .guess-box[data-value="3"] .dot:nth-child(2) { top: 50%; left: 50%; transform: translate(-50%, -50%); }
    .dice[data-value="3"] .dot:nth-child(3), .guess-box[data-value="3"] .dot:nth-child(3) { bottom: 15%; right: 15%; }
    .dice[data-value="4"] .dot:nth-child(1), .guess-box[data-value="4"] .dot:nth-child(1) { top: 15%; left: 15%; }
    .dice[data-value="4"] .dot:nth-child(2), .guess-box[data-value="4"] .dot:nth-child(2) { top: 15%; right: 15%; }
    .dice[data-value="4"] .dot:nth-child(3), .guess-box[data-value="4"] .dot:nth-child(3) { bottom: 15%; left: 15%; }
    .dice[data-value="4"] .dot:nth-child(4), .guess-box[data-value="4"] .dot:nth-child(4) { bottom: 15%; right: 15%; }
    .dice[data-value="5"] .dot:nth-child(1), .guess-box[data-value="5"] .dot:nth-child(1) { top: 15%; left: 15%; }
    .dice[data-value="5"] .dot:nth-child(2), .guess-box[data-value="5"] .dot:nth-child(2) { top: 15%; right: 15%; }
    .dice[data-value="5"] .dot:nth-child(3), .guess-box[data-value="5"] .dot:nth-child(3) { top: 50%; left: 50%; transform: translate(-50%, -50%); }
    .dice[data-value="5"] .dot:nth-child(4), .guess-box[data-value="5"] .dot:nth-child(4) { bottom: 15%; left: 15%; }
    .dice[data-value="5"] .dot:nth-child(5), .guess-box[data-value="5"] .dot:nth-child(5) { bottom: 15%; right: 15%; }
    .dice[data-value="6"] .dot:nth-child(1), .guess-box[data-value="6"] .dot:nth-child(1) { top: 15%; left: 15%; }
    .dice[data-value="6"] .dot:nth-child(2), .guess-box[data-value="6"] .dot:nth-child(2) { top: 15%; right: 15%; }
    .dice[data-value="6"] .dot:nth-child(3), .guess-box[data-value="6"] .dot:nth-child(3) { top: 50%; left: 15%; }
    .dice[data-value="6"] .dot:nth-child(4), .guess-box[data-value="6"] .dot:nth-child(4) { top: 50%; right: 15%; }
    .dice[data-value="6"] .dot:nth-child(5), .guess-box[data-value="6"] .dot:nth-child(5) { bottom: 15%; left: 15%; }
    .dice[data-value="6"] .dot:nth-child(6), .guess-box[data-value="6"] .dot:nth-child(6) { bottom: 15%; right: 15%; }

    /* Dice rolling animation - TIDAK BERUBAH SESUAI PERMINTAAN */
    .dice.rolling {
        animation: shakeDice 0.2s infinite alternate;
        transform-style: preserve-3d;
    }
    @keyframes shakeDice {
        0% { transform: translate(0px, 0px) rotateX(0deg) rotateY(0deg) rotateZ(0deg); }
        25% { transform: translate(5px, -5px) rotateX(10deg) rotateY(-10deg) rotateZ(5deg); }
        50% { transform: translate(-5px, 5px) rotateX(-10deg) rotateY(10deg) rotateZ(-5deg); }
        75% { transform: translate(5px, 5px) rotateX(10deg) rotateY(10deg) rotateZ(5deg); }
        100% { transform: translate(-5px, -5px) rotateX(-10deg) rotateY(-10deg) rotateZ(-5deg); }
    }

    /* Animal Dice Specific Styling (for emojis) - TIDAK BERUBAH SESUAI PERMINTAAN */
    .dice.animal, .guess-box.animal {
      font-size: 32px;
      background: #fff;
      color: #28a745;
      border-color: red;
      line-height: 1;
    }
    
    .bet-section, .guess-section {
      margin-bottom: 20px; /* Jarak antar section */
      text-align: center;
    }
    label {
      display: block;
      margin-bottom: 10px; /* Jarak antara label dan input/pilihan */
      font-weight: 700;
      font-size: 1.1em; /* Ukuran font label */
      color: var(--neon-blue); /* Warna label biru neon */
      text-shadow: 0 0 5px var(--neon-blue);
    }
    
    /* Bet Control */
    .bet-control {
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 15px; /* Jarak antara tombol dan tampilan taruhan */
        margin-top: 5px;
        margin-bottom: 20px;
    }

    .bet-control #display-bet-amount {
        font-family: 'Orbitron', sans-serif;
        font-size: 24px; /* Ukuran font taruhan */
        font-weight: 700;
        color: var(--neon-green); /* Warna hijau neon */
        min-width: 120px; /* Agar ukurannya stabil */
        text-align: center;
        padding: 8px 15px;
        background: rgba(0, 0, 0, 0.7);
        border-radius: 8px;
        border: 2px solid var(--neon-green);
        box-shadow: 0 0 10px rgba(0, 255, 0, 0.5);
    }

    .btn-bet-adjust {
        background: var(--neon-purple); /* Warna ungu neon */
        color: #fff;
        border: none;
        border-radius: 50%;
        width: 45px; /* Ukuran tombol */
        height: 45px;
        font-size: 28px; /* Ukuran font tombol */
        font-weight: 700;
        cursor: pointer;
        display: flex;
        justify-content: center;
        align-items: center;
        transition: background 0.3s, transform 0.2s, box-shadow 0.3s;
        box-shadow: 0 0 10px var(--neon-purple);
    }

    .btn-bet-adjust:hover {
        background: #ff66ff; /* Warna ungu lebih terang */
        transform: translateY(-2px);
        box-shadow: 0 0 15px #ff66ff;
    }
    .btn-bet-adjust:active {
        transform: translateY(0);
        box-shadow: none;
    }

    /* Guess Options - Boxes (untuk angka dan hewan) */
    .guess-options-grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 10px; /* Jarak antar kotak */
        margin-bottom: 20px;
        max-width: 240px; /* Sesuaikan dengan ukuran dadu */
        margin-left: auto;
        margin-right: auto;
    }
    .guess-options-grid input[type="radio"] {
        display: none;
    }
    .guess-options-grid label.guess-box {
        cursor: pointer;
        background: rgba(0, 0, 0, 0.6); /* Background gelap */
        border: 2px solid var(--neon-blue); /* Border biru neon */
        color: var(--light-text);
        transition: background 0.3s, border-color 0.3s, transform 0.2s, box-shadow 0.3s;
        font-weight: 600;
        font-size: 1em;
        display: flex;
        justify-content: center;
        align-items: center;
        user-select: none;
        height: 70px; /* Sama tinggi dengan dadu */
        position: relative;
        border-radius: 15px; /* Sesuai dengan dadu */
        box-shadow: 0 0 8px rgba(0, 255, 255, 0.3);
    }

    .guess-options-grid label.guess-box:hover {
        transform: translateY(-3px); /* Angkat lebih tinggi saat hover */
        box-shadow: 0 0 15px rgba(0, 255, 255, 0.7);
    }
    .guess-options-grid input[type="radio"]:checked + label.guess-box {
        background: var(--neon-blue); /* Warna biru neon saat dipilih */
        border-color: var(--neon-green); /* Border hijau neon saat dipilih */
        color: #000; /* Warna teks gelap agar kontras */
        font-weight: 700;
        transform: scale(1.05); /* Skala lebih besar saat dipilih */
        box-shadow: 0 0 20px var(--neon-blue), 0 0 30px var(--neon-green); /* Glow lebih kuat */
    }

    /* Specific styling for guess number boxes */
    .guess-options-grid label.guess-box.number-guess-box .dot {
        background: red; /* Tetap merah */
    }

    /* Specific styling for guess animal boxes */
    .guess-options-grid label.guess-box.animal-guess-box {
      background: rgba(0, 0, 0, 0.6);
      /* Emojis have their own colors, no need to set color here */
      border-color: var(--neon-purple); /* Border ungu neon */
      font-size: 32px;
      line-height: 1;
      box-shadow: 0 0 8px rgba(255, 0, 255, 0.3);
    }
    .guess-options-grid input[type="radio"]:checked + label.guess-box.animal-guess-box {
        background: var(--neon-purple); /* Warna ungu neon saat dipilih */
        border-color: var(--neon-green); /* Border hijau neon saat dipilih */
        color: #000; /* Emojis will likely ignore this, but good practice */
        box-shadow: 0 0 20px var(--neon-purple), 0 0 30px var(--neon-green); /* Glow lebih kuat */
    }


    /* Roll Button (menyesuaikan dengan tombol di profil.html) */
    .btn {
      background: linear-gradient(90deg, var(--neon-green), var(--neon-blue)); /* Gradien neon */
      border: 2px solid var(--neon-green);
      border-radius: 30px;
      padding: 15px 30px; /* Padding lebih besar */
      font-size: 20px; /* Ukuran font lebih besar */
      font-weight: 700;
      cursor: pointer;
      color: #fff;
      text-shadow: 0 0 5px rgba(0, 255, 0, 0.8), 0 0 5px rgba(0, 255, 255, 0.8);
      box-shadow: var(--btn-glow); /* Glow tombol */
      transition: all 0.3s ease;
      width: 100%;
      margin-top: 30px; /* Lebih banyak jarak */
      display: block;
      max-width: 350px; /* Batasi lebar tombol */
      margin-left: auto;
      margin-right: auto;
    }
    .btn:hover:not(:disabled) {
        background: linear-gradient(90deg, var(--neon-blue), var(--neon-green)); /* Balik gradien */
        transform: translateY(-3px); /* Angkat lebih tinggi */
        box-shadow: 0 0 25px var(--neon-green), 0 0 35px var(--neon-blue);
        border-color: var(--neon-blue);
    }
    .btn:disabled {
        background: #333;
        color: #888;
        cursor: not-allowed;
        box-shadow: none;
        transform: none;
        border-color: #555;
    }

    /* ==== MODAL NOTIFIKASI (dari profil.html) ==== */
    #notificationModal {
        display: none; /* Hidden by default */
        position: fixed; /* Stay in place */
        z-index: 1000; /* Sit on top */
        left: 0;
        top: 0;
        width: 100%; /* Full width */
        height: 100%; /* Full height */
        overflow: auto; /* Enable scroll if needed */
        background-color: rgba(0,0,0,0.8); /* Black w/ opacity */
        display: flex;
        justify-content: center;
        align-items: center;
        opacity: 0;
        visibility: hidden;
        transition: opacity 0.3s ease, visibility 0.3s ease;
    }

    #notificationModal.active {
        opacity: 1;
        visibility: visible;
    }

    .notification-modal-content {
        background: #1a0033; /* Dark purple background */
        padding: 30px;
        border-radius: 15px;
        border: 2px solid var(--neon-blue);
        box-shadow: 0 0 25px var(--neon-blue);
        width: 90%;
        max-width: 450px;
        text-align: center;
        position: relative;
        animation: fadeInScale 0.3s ease-out;
    }

    @keyframes fadeInScale {
        from { opacity: 0; transform: scale(0.9); }
        to { opacity: 1; transform: scale(1); }
    }

    .notification-modal-content h2 {
        font-family: 'Orbitron', sans-serif;
        color: var(--neon-green);
        text-shadow: 0 0 10px var(--neon-green);
        margin-top: 0;
        margin-bottom: 20px;
        font-size: 2em;
    }

    .notification-modal-content p {
        font-family: 'Poppins', sans-serif;
        color: var(--light-text);
        font-size: 1.1em;
        line-height: 1.6;
        margin-bottom: 25px;
    }

    .notification-modal-content button {
        background: linear-gradient(90deg, var(--neon-green), var(--neon-blue));
        border: 2px solid var(--neon-green);
        border-radius: 25px;
        padding: 12px 25px;
        font-size: 1.1em;
        font-weight: 700;
        color: #fff;
        text-shadow: 0 0 5px rgba(0, 255, 0, 0.8), 0 0 5px rgba(0, 255, 255, 0.8);
        box-shadow: var(--btn-glow);
        cursor: pointer;
        transition: all 0.3s ease;
    }

    .notification-modal-content button:hover {
        background: linear-gradient(90deg, var(--neon-blue), var(--neon-green));
        transform: translateY(-2px);
        box-shadow: 0 0 20px var(--neon-green), 0 0 30px var(--neon-blue);
        border-color: var(--neon-blue);
    }
    /* === AKHIR MODAL NOTIFIKASI === */

    /* Media queries untuk responsif */
    @media (max-width: 550px) {
        .game-container {
            padding: 25px;
            border-radius: 15px;
            min-height: 70vh;
        }
        h1 { font-size: 2.2em; margin-bottom: 15px; }
        .saldo { font-size: 1.5em; padding: 8px 15px; }
        .dice-area { gap: 10px; margin-bottom: 25px; min-height: 80px; }
        .dice, .guess-box {
            width: 60px;
            height: 60px;
        }
        .dice .dot, .guess-box .dot {
            width: 8px;
            height: 8px;
        }
        .dice.animal, .guess-box.animal {
            font-size: 28px;
        }
        label { font-size: 1em; margin-bottom: 8px; }
        .bet-control #display-bet-amount {
            font-size: 20px;
            padding: 6px 12px;
            min-width: 100px;
        }
        .btn-bet-adjust {
            width: 40px;
            height: 40px;
            font-size: 24px;
        }
        .guess-options-grid {
            gap: 8px;
            max-width: 200px; /* 3 x 60px + 2 x 8px */
            margin-bottom: 15px;
        }
        .guess-options-grid label.guess-box {
            height: 60px;
            font-size: 0.9em;
        }
        .btn { padding: 12px 25px; font-size: 18px; margin-top: 20px; }
        .notification-modal-content { padding: 25px; max-width: 400px; }
        .notification-modal-content h2 { font-size: 1.8em; margin-bottom: 15px; }
        .notification-modal-content p { font-size: 1em; margin-bottom: 20px; }
        .notification-modal-content button { padding: 10px 20px; font-size: 1em; }
    }

    @media (max-width: 400px) {
        body { padding: 10px; }
        .game-container {
            padding: 20px;
            border-radius: 10px;
            min-height: 60vh;
        }
        h1 { font-size: 1.8em; margin-bottom: 10px; }
        .saldo { font-size: 1.2em; padding: 6px 10px; }
        .dice-area { gap: 8px; margin-bottom: 20px; min-height: 70px; }
        .dice, .guess-box {
            width: 50px;
            height: 50px;
        }
        .dice .dot, .guess-box .dot {
            width: 7px;
            height: 7px;
        }
        .dice.animal, .guess-box.animal {
            font-size: 24px;
        }
        label { font-size: 0.9em; margin-bottom: 5px; }
        .bet-control { gap: 10px; margin-bottom: 15px; }
        .bet-control #display-bet-amount {
            font-size: 18px;
            padding: 5px 10px;
            min-width: 80px;
        }
        .btn-bet-adjust {
            width: 35px;
            height: 35px;
            font-size: 20px;
        }
        .guess-options-grid {
            gap: 6px;
            max-width: 170px; /* 3 x 50px + 2 x 6px */
            margin-bottom: 12px;
        }
        .guess-options-grid label.guess-box {
            height: 50px;
           font-size: 0.8em;
        }
        .btn { padding: 10px 20px; font-size: 16px; margin-top: 15px; }
        .notification-modal-content { padding: 20px; max-width: 350px; }
        .notification-modal-content h2 { font-size: 1.6em; margin-bottom: 12px; }
        .notification-modal-content p { font-size: 0.95em; margin-bottom: 18px; }
        .notification-modal-content button { padding: 8px 18px; font-size: 0.9em; }
    }
  </style>
</head>
<body>
  <div class="game-container" id="game-container">
    <h1>Tebak Dadu Fantasi </h1>
    <div class="saldo-container">
        <div class="saldo" id="saldo-display">Saldo: Rp.0</div>
    </div>

    <div class="dice-area">
      <div class="dice" id="die1" data-value="?">
        <span class="dot"></span><span class="dot"></span><span class="dot"></span>
        <span class="dot"></span><span class="dot"></span><span class="dot"></span>
      </div>
      <div class="dice" id="die2" data-value="?">
        <span class="dot"></span><span class="dot"></span><span class="dot"></span>
        <span class="dot"></span><span class="dot"></span><span class="dot"></span>
      </div>
      <div class="dice" id="die3" data-value="?">
        <span class="dot"></span><span class="dot"></span><span class="dot"></span>
        <span class="dot"></span><span class="dot"></span><span class="dot"></span>
      </div>
      <div class="dice animal" id="animal-die">❓</div> </div>

    <div class="bet-section">
        <label>Jumlah Taruhan:</label>
        <div class="bet-control">
         <button class="btn-bet-adjust" id="decrease-bet">-</button>
            <span id="display-bet-amount">Rp100</span> <button class="btn-bet-adjust" id="increase-bet">+</button>
        </div>
    </div>

    <div class="guess-section">
      <label>Tebakan Angka Dadu (1-6)</label>
      <div class="guess-options-grid">
        <input type="radio" id="guess-num-1" name="number-guess" value="1">
        <label for="guess-num-1" class="guess-box number-guess-box" data-value="1">
            <span class="dot"></span>
        </label>
        <input type="radio" id="guess-num-2" name="number-guess" value="2">
        <label for="guess-num-2" class="guess-box number-guess-box" data-value="2">
            <span class="dot"></span><span class="dot"></span>
        </label>
        <input type="radio" id="guess-num-3" name="number-guess" value="3">
        <label for="guess-num-3" class="guess-box number-guess-box" data-value="3">
            <span class="dot"></span><span class="dot"></span><span class="dot"></span>
        </label>
        <input type="radio" id="guess-num-4" name="number-guess" value="4">
        <label for="guess-num-4" class="guess-box number-guess-box" data-value="4">
            <span class="dot"></span><span class="dot"></span><span class="dot"></span><span class="dot"></span>
        </label>
        <input type="radio" id="guess-num-5" name="number-guess" value="5">
        <label for="guess-num-5" class="guess-box number-guess-box" data-value="5">
            <span class="dot"></span><span class="dot"></span><span class="dot"></span><span class="dot"></span><span class="dot"></span>
        </label>
        <input type="radio" id="guess-num-6" name="number-guess" value="6">
        <label for="guess-num-6" class="guess-box number-guess-box" data-value="6">
            <span class="dot"></span><span class="dot"></span><span class="dot"></span><span class="dot"></span><span class="dot"></span><span class="dot"></span>
        </label>
      </div>
    </div>

    <div class="guess-section">
      <label> Tebakan Simbol Hewan (x4)</label>
      <div class="guess-options-grid">
        <input type="radio" id="guess-gajah" name="animal-guess" value="gajah">
        <label for="guess-gajah" class="guess-box animal-guess-box">🐘</label>
        <input type="radio" id="guess-singa" name="animal-guess" value="singa">
        <label for="guess-singa" class="guess-box animal-guess-box">🦁</label>
        <input type="radio" id="guess-monyet" name="animal-guess" value="monyet">
        <label for="guess-monyet" class="guess-box animal-guess-box">🐒</label>
        <input type="radio" id="guess-ular" name="animal-guess" value="ular">
        <label for="guess-ular" class="guess-box animal-guess-box">🐍</label>
        <input type="radio" id="guess-burung" name="animal-guess" value="burung">
        <label for="guess-burung" class="guess-box animal-guess-box">🐦</label>
        <input type="radio" id="guess-ikan" name="animal-guess" value="ikan">
        <label for="guess-ikan" class="guess-box animal-guess-box">🐠</label>
      </div>
    </div>

    <button class="btn" id="roll-dice-btn">Gulirkan Dadu!</button>
  </div>

  <div id="notificationModal" class="notification-modal">
    <div class="notification-modal-content">
        <h2 id="notificationTitle"></h2>
        <p id="notificationMessage"></p>
        <button id="notificationCloseBtn">Oke</button>
    </div>
  </div>

  <audio id="bg-music" loop>
    <source src="https://vqmfachxnjyxwuavpgds.supabase.co/storage/v1/object/public/music//dj-background-music-background-music-free-music-music-free-for-use-221916%20(1).mp3" type="audio/mp3">
    Your browser does not support the audio element.
  </audio>
  <audio id="click-sound">
    <source src="https://vqmfachxnjyxwuavpgds.supabase.co/storage/v1/object/public/music//mixkit-game-ball-tap-2073.mp3" type="audio/mp3">
    Your browser does not support the audio element.
  </audio>
  <audio id="win-sound">
    <source src="https://vqmfachxnjyxwuavpgds.supabase.co/storage/v1/object/public/music//mixkit-game-level-completed-2059.mp3" type="audio/mp3">
    Your browser does not support the audio element.
  </audio>
  <audio id="lose-sound">
    <source src="https://vqmfachxnjyxwuavpgds.supabase.co/storage/v1/object/public/music//mixkit-player-losing-or-failing-2042.mp3" type="audio/mp3">
    Your browser does not support the audio element.
  </audio>
  <audio id="dice-roll-sound">
    <source src="https://vqmfachxnjyxwuavpgds.supabase.co/storage/v1/object/public/music//mixkit-arcade-video-game-machine-alert-2821%20(mp3cut.net).mp3" type="audio/mp3">
    Your browser does not support the audio element.
  </audio>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script>
    const supabase = window.supabase.createClient(
      'https://vqmfachxnjyxwuavpgds.supabase.co',
      'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZxbWZhY2h4bmp5eHd1YXZwZ2RzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDg0MDYxNDAsImV4cCI6MjA2Mzk4MjE0MH0.Bzr8mUiEl8MzRWpVQ3_59eFxKk0EWZ3ca-4IEcpGLkk'
    );

    let uid = localStorage.getItem('uid');
    let currentSaldo = 0;

    const saldoDisplay = document.getElementById('saldo-display');
    const numberGuessOptions = document.querySelectorAll('input[name="number-guess"]');
    const animalGuessOptions = document.querySelectorAll('input[name="animal-guess"]');
    const rollDiceBtn = document.getElementById('roll-dice-btn');
    const die1Display = document.getElementById('die1');
    const die2Display = document.getElementById('die2');
    const die3Display = document.getElementById('die3');
    const animalDieDisplay = document.getElementById('animal-die');

    // New Bet Adjustment Elements
    const decreaseBetBtn = document.getElementById('decrease-bet');
    const increaseBetBtn = document.getElementById('increase-bet');
    const displayBetAmount = document.getElementById('display-bet-amount');

    const MIN_BET_UNIT = 200;
    const BET_STEP = 100;
    let currentManualBet = MIN_BET_UNIT;

    // Audio Elements
    const bgMusic = document.getElementById('bg-music');
    const clickSound = document.getElementById('click-sound');
    const winSound = document.getElementById('win-sound');
    const loseSound = document.getElementById('lose-sound');
    const diceRollSound = document.getElementById('dice-roll-sound');

    // Modal Notifikasi Elements
    const notificationModal = document.getElementById('notificationModal');
    const notificationTitle = document.getElementById('notificationTitle');
    const notificationMessage = document.getElementById('notificationMessage');
    const notificationCloseBtn = document.getElementById('notificationCloseBtn');

    // Animal mapping using EMOJIS
    const animals = {
      gajah: '🐘',
      singa: '🦁',
      monyet: '🐒',
      ular: '🐍',
      burung: '🐦',
      ikan: '🐠',
    };
    const animalKeys = Object.keys(animals);

    document.addEventListener('DOMContentLoaded', async () => {
      await loadUserProfile();
      rollDiceBtn.addEventListener('click', playDiceGame);
      
      decreaseBetBtn.addEventListener('click', () => {
          if (currentManualBet > MIN_BET_UNIT) {
              currentManualBet -= BET_STEP;
              displayBetAmount.textContent = `Rp.${currentManualBet.toLocaleString('id-ID')}`;
              clickSound.play();
          }
      });

      increaseBetBtn.addEventListener('click', () => {
          currentManualBet += BET_STEP;
          displayBetAmount.textContent = `Rp.${currentManualBet.toLocaleString('id-ID')}`;
          clickSound.play();
      });

      displayBetAmount.textContent = `Rp.${currentManualBet.toLocaleString('id-ID')}`;

      // Play background music on user interaction (e.g., first click)
      document.body.addEventListener('click', () => {
        if (bgMusic.paused) {
          bgMusic.play().catch(e => console.warn("Failed to play background music:", e));
          bgMusic.volume = 0.3;
        }
      }, { once: true });

      createParticles();
    });

    // Function untuk menampilkan modal notifikasi (dari profil.html)
    function showNotificationModal(title, message) {
        notificationTitle.textContent = title;
        notificationMessage.innerHTML = message; /* Use innerHTML to allow for bold tags */
        notificationModal.classList.add('active');
        notificationCloseBtn.onclick = () => {
            notificationModal.classList.remove('active');
            clickSound.play();
        };
    }

    // Particle effect
    function createParticles() {
        const container = document.getElementById('game-container');
        for (let i = 0; i < 20; i++) {
            const particle = document.createElement('div');
            particle.className = 'particle';
            const size = Math.random() * 8 + 4;
            particle.style.width = `${size}px`;
            particle.style.height = `${size}px`;
            particle.style.left = `${Math.random() * 100}%`;
            particle.style.animationDelay = `${Math.random() * 5}s`;
            particle.style.setProperty('--x-offset', `${(Math.random() - 0.5) * 100}px`);
            container.appendChild(particle);
        }
    }

    async function loadUserProfile() {
      if (!uid) {
        showNotificationModal('Perhatian!', 'Anda harus login untuk bermain game ini.');
        // Beri sedikit waktu agar modal muncul sebelum redirect
        setTimeout(() => {
            window.location.href = 'login.html';
        }, 2000);
        return;
      }

      const { data: userData, error: userError } = await supabase
        .from('users_data')
        .select('saldo')
        .eq('user_id', uid)
        .single();

      if (userError && userError.code === 'PGRST116') {
        console.warn('Pengguna baru, membuat entri saldo awal...');
        const { error: insertError } = await supabase
            .from('users_data')
            .insert([{ user_id: uid, saldo: 0 }]);
        if (insertError) {
            console.error('Error saat membuat entri saldo awal:', insertError.message);
            showNotificationModal('Error', 'Gagal membuat entri saldo awal. Cek log.');
            currentSaldo = 0;
        } else {
            currentSaldo = 0;
        }
      } else if (userError) {
        console.error('Error memuat data saldo:', userError.message);
        showNotificationModal('Error', 'Gagal memuat saldo: ' + userError.message);
        currentSaldo = 0;
      } else {
        currentSaldo = userData.saldo ?? 0;
      }
      saldoDisplay.textContent = `Saldo: Rp.${currentSaldo.toLocaleString('id-ID')}`;
    }

    async function updateSaldoInSupabase(amount) {
      const { data, error } = await supabase
        .from('users_data')
        .update({ saldo: amount })
        .eq('user_id', uid);

      if (error) {
        console.error('Error memperbarui saldo:', error.message);
        showNotificationModal('Error', 'Gagal memperbarui saldo di database. Harap hubungi admin.');
        return false;
      }
      return true;
    }

    function renderDiceDots(element, value) {
        element.innerHTML = '';
        element.setAttribute('data-value', value);
        if (value === '?') return;

        const numDots = value;
        for (let i = 0; i < numDots; i++) {
            const dot = document.createElement('span');
            dot.className = 'dot';
            element.appendChild(dot);
        }
    }

    function getRandomDiceRoll() {
      return Math.floor(Math.random() * 6) + 1;
    }

    function getRandomAnimal() {
      const randomIndex = Math.floor(Math.random() * animalKeys.length);
      return animalKeys[randomIndex];
    }

    async function playDiceGame() {
      clickSound.play();

      let betAmount = 0;
      let selectedNumberGuess = null;
      for (const radio of numberGuessOptions) {
        if (radio.checked) {
          selectedNumberGuess = radio.value;
          break;
        }
      }

      let selectedAnimalGuess = null;
      for (const radio of animalGuessOptions) {
        if (radio.checked) {
          selectedAnimalGuess = radio.value;
          break;
        }
      }

      if (selectedNumberGuess && selectedAnimalGuess) {
          betAmount = currentManualBet * 2;
      } else if (selectedNumberGuess || selectedAnimalGuess) {
          betAmount = currentManualBet;
      } else {
          showNotificationModal('Perhatian!', 'Pilih tebakan Angka (1-6) atau tebakan Simbol Hewan.');
          return;
      }

      if (currentSaldo < betAmount) {
        showNotificationModal('Saldo Tidak Cukup!', `Saldo Anda tidak cukup untuk taruhan ini! Diperlukan <b>Rp.${betAmount.toLocaleString('id-ID')}</b>.`);
        return;
      }

      // Disable buttons and inputs
      rollDiceBtn.disabled = true;
      decreaseBetBtn.disabled = true;
      increaseBetBtn.disabled = true;
      numberGuessOptions.forEach(radio => radio.disabled = true);
      animalGuessOptions.forEach(radio => radio.disabled = true);

      // Deduct bet immediately
      currentSaldo -= betAmount;
      const successDeduct = await updateSaldoInSupabase(currentSaldo);
      if (!successDeduct) {
        currentSaldo += betAmount;
        saldoDisplay.textContent = `Saldo: Rp.${currentSaldo.toLocaleString('id-ID')}`;
        rollDiceBtn.disabled = false;
        decreaseBetBtn.disabled = false;
        increaseBetBtn.disabled = false;
        numberGuessOptions.forEach(radio => radio.disabled = false);
        animalGuessOptions.forEach(radio => radio.disabled = false);
        return;
      }
      saldoDisplay.textContent = `Saldo: Rp.${currentSaldo.toLocaleString('id-ID')}`;

      // Animate dice rolling
      die1Display.classList.add('rolling');
      die2Display.classList.add('rolling');
      die3Display.classList.add('rolling');
      animalDieDisplay.classList.add('rolling');

      renderDiceDots(die1Display, '?');
      renderDiceDots(die2Display, '?');
      renderDiceDots(die3Display, '?');
      animalDieDisplay.innerHTML = '❓';

      diceRollSound.play();

      setTimeout(async () => {
        die1Display.classList.remove('rolling');
        die2Display.classList.remove('rolling');
        die3Display.classList.remove('rolling');
        animalDieDisplay.classList.remove('rolling');

        const die1 = getRandomDiceRoll();
        const die2 = getRandomDiceRoll();
        const die3 = getRandomDiceRoll();
        const animalResultKey = getRandomAnimal();
        const animalResultEmoji = animals[animalResultKey];

        renderDiceDots(die1Display, die1);
        renderDiceDots(die2Display, die2);
        renderDiceDots(die3Display, die3);
        animalDieDisplay.innerHTML = animalResultEmoji;

        let totalProfit = 0;
        let winDetails = [];
        let isAnyWin = false;

        // Check Animal Guess
        if (selectedAnimalGuess) {
            if (selectedAnimalGuess === animalResultKey) {
                const winMultiplier = 4;
                const animalWinAmount = currentManualBet * winMultiplier;
                totalProfit += currentManualBet * (winMultiplier - 1);
                winDetails.push(`Tebakan Hewan: <b>${animals[selectedAnimalGuess]} (${selectedAnimalGuess.charAt(0).toUpperCase() + selectedAnimalGuess.slice(1)})</b> tepat! Anda memenangkan <b>Rp.${animalWinAmount.toLocaleString('id-ID')}</b> (taruhan Rp.${currentManualBet.toLocaleString('id-ID')} x${winMultiplier}).`);
                isAnyWin = true;
            } else {
                winDetails.push(`Tebakan Hewan: <b>${animals[selectedAnimalGuess]} (${selectedAnimalGuess.charAt(0).toUpperCase() + selectedAnimalGuess.slice(1)})</b> salah. Hasil: <b>${animals[animalResultKey]} (${animalResultKey.charAt(0).toUpperCase() + animalResultKey.slice(1)})</b>.`);
            }
        }

        // Check Number Guess
        if (selectedNumberGuess) {
            const guessedNumber = parseInt(selectedNumberGuess);
            let numberMatches = 0;
            if (die1 === guessedNumber) { numberMatches++; }
            if (die2 === guessedNumber) { numberMatches++; }
            if (die3 === guessedNumber) { numberMatches++; }

            if (numberMatches > 0) {
                const multiplier = numberMatches;
                const numberWinAmount = currentManualBet * (multiplier + 1);
                totalProfit += currentManualBet * multiplier;
                winDetails.push(`Tebakan Angka: <b>${guessedNumber}</b> tepat (${numberMatches} kali)! Anda memenangkan <b>Rp${numberWinAmount.toLocaleString('id-ID')}</b> (taruhan Rp${currentManualBet.toLocaleString('id-ID')} x${multiplier+1}).`);
                isAnyWin = true;
            } else {
                winDetails.push(`Tebakan Angka: <b>${guessedNumber}</b> salah. Tidak ada dadu angka yang menunjukkan ${guessedNumber}.`);
            }
        }

        let messageTitle = "";
        let messageBody = "";

        if (isAnyWin) {
            currentSaldo += betAmount + totalProfit;
            messageTitle = "Selamat! Anda Menang!";
            messageBody = `Total kemenangan Anda: <b>Rp.${(betAmount + totalProfit).toLocaleString('id-ID')}</b>.<br><br>` + winDetails.join('<br>');
            winSound.play();
        } else {
            messageTitle = "Anda Kalah!";
            messageBody = `Taruhan Anda <b>Rp.${betAmount.toLocaleString('id-ID')}</b> hangus.<br><br>` + winDetails.join('<br>');
            loseSound.play();
        }

        await updateSaldoInSupabase(currentSaldo);
        saldoDisplay.textContent = `Saldo: Rp.${currentSaldo.toLocaleString('id-ID')}`;

        // Menggunakan showNotificationModal yang sudah disesuaikan
        showNotificationModal(messageTitle, messageBody);

        rollDiceBtn.disabled = false;
        decreaseBetBtn.disabled = false;
        increaseBetBtn.disabled = false;
        numberGuessOptions.forEach(radio => radio.disabled = false);
        animalGuessOptions.forEach(radio => radio.disabled = false);

      }, 2500);
    }
  </script>
</body>
</html>